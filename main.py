from json import dumps
from re import sub
from subprocess import run, PIPE, TimeoutExpired
from demjson3 import decode

ARKOSE_WORKER_CODE = '''function o(){const EM=['\x47\x73\x67\x70\x63','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x78\x6a\x4f\x66\x66','\x77\x4f\x48\x74\x6d','\x69\x58\x76\x48\x63','\x74\x79\x70\x65','\x42\x63\x59\x64\x67','\x4e\x6d\x42\x51\x41','\x73\x6a\x41\x4c\x74','\x61\x70\x70\x6c\x79','\x4b\x7a\x64\x50\x7a','\x35\x31\x35\x39\x4d\x64\x64\x63\x51\x4d','\x36\x36\x35\x36\x34\x39\x57\x42\x6f\x4a\x52\x5a','\x72\x64\x4d\x71\x63','\x78\x54\x70\x72\x73','\x5a\x79\x72\x77\x54','\x54\x69\x6d\x65\x64\x20\x6f\x75\x74\x20','\x31\x33\x32\x36\x33\x30\x34\x6e\x4b\x78\x51\x78\x77','\x6f\x63\x74\x6f\x70\x75\x73','\x68\x6f\x72\x73\x65','\x5a\x65\x62\x72\x61','\x73\x75\x71\x48\x42','\x44\x4f\x4e\x45','\x63\x61\x6e\x63\x65\x6c','\x56\x75\x6c\x74\x75\x72\x65','\x6a\x64\x4a\x5a\x66','\x63\x65\x69\x6c','\x4f\x63\x74\x6f\x70\x75\x73','\x4a\x61\x67\x75\x61\x72','\x72\x65\x64\x75\x63\x65','\x69\x67\x75\x61\x6e\x61','\x79\x63\x46\x43\x64','\x50\x4f\x57\x5f\x54\x49\x4d\x45\x4f\x55','\x69\x74\x69\x6d\x65\x6f\x75\x74','\x44\x61\x74\x61','\x73\x68\x65\x65\x70','\x67\x69\x72\x61\x66\x66\x65','\x4d\x64\x50\x47\x66','\x51\x6a\x59\x4a\x78','\x72\x6f\x75\x6e\x64','\x69\x6e\x73\x69\x64\x65\x20\x77\x6f\x72','\x20\x77\x6f\x72\x6b','\x45\x42\x49\x77\x4c','\x6c\x6c\x65\x64','\x41\x6e\x74','\x74\x69\x67\x65\x72','\x69\x52\x4b\x64\x5a','\x70\x75\x73\x68','\x73\x66\x47\x62\x6e','\x53\x48\x51\x6f\x56','\x73\x65\x65\x64','\x70\x70\x4a\x63\x55','\x66\x69\x6e\x64','\x49\x46\x45\x70\x41','\x74\x61\x72\x67\x65\x74\x48\x61\x73\x68','\x50\x65\x6e\x67\x75\x69\x6e','\x52\x61\x62\x62\x69\x74','\x58\x49\x48\x4f\x4e','\x6e\x51\x44\x59\x79','\x70\x65\x6e\x67\x75\x69\x6e','\x77\x5a\x64\x46\x7a','\x6e\x65\x77\x74','\x4e\x65\x77\x74','\x77\x6f\x72\x6b\x5f\x74\x69\x6d\x65\x6f','\x76\x75\x6c\x74\x75\x72\x65','\x66\x67\x7a\x72\x70','\x79\x61\x6b','\x74\x61\x72\x67\x65\x74','\x50\x6a\x68\x43\x57','\x6f\x41\x50\x58\x67','\x6d\x6f\x6e\x6b\x65\x79','\x62\x75\x66\x66\x65\x72','\x45\x52\x52\x4f\x52','\x6d\x48\x45\x45\x46','\x68\x55\x7a\x44\x7a','\x72\x75\x6e\x74\x69\x6d\x65\x5f\x65\x72','\x74\x69\x6d\x65\x6f\x75\x74\x20\x63\x61','\x62\x76\x71\x65\x49','\x53\x68\x67\x6f\x73','\x6e\x6f\x77','\x69\x57\x6b\x6c\x65','\x47\x69\x72\x61\x66\x66\x65','\x6c\x6f\x67','\x68\x61\x73\x68\x52\x61\x74\x65','\x66\x46\x57\x6a\x6c','\x6d\x61\x70','\x34\x30\x34\x34\x36\x33\x35\x53\x73\x49\x74\x75\x49','\x6c\x65\x6e\x67\x74\x68','\x6c\x69\x6f\x6e','\x69\x78\x6a\x69\x53','\x4c\x4f\x41\x44\x45\x44','\x61\x75\x47\x54\x65','\x72\x6f\x72','\x53\x68\x65\x65\x70','\x6c\x6f\x61\x64\x65\x64','\x5a\x74\x73\x68\x59','\x6a\x66\x64\x70\x4b','\x45\x72\x72\x6f\x72\x20\x77\x68\x65\x6e','\x72\x61\x62\x62\x69\x74','\x6b\x65\x72','\x55\x6e\x6b\x6e\x6f\x77\x6e\x20\x65\x72','\x66\x70\x47\x62\x77','\x43\x61\x74','\x48\x6f\x72\x73\x65','\x31\x35\x37\x37\x33\x33\x33\x30\x7a\x6a\x48\x66\x73\x4c','\x42\x69\x54\x73\x59','\x73\x70\x6c\x69\x74','\x43\x41\x41\x51\x70','\x6e\x48\x44\x61\x47','\x74\x6f\x4c\x6f\x77\x65\x72\x43\x61\x73','\x52\x67\x54\x46\x59','\x73\x74\x72\x69\x6e\x67\x69\x66\x79','\x56\x53\x67\x78\x68','\x57\x68\x61\x6c\x65','\x6d\x65\x73\x73\x61\x67\x65','\x76\x47\x74\x70\x4d','\x4f\x4c\x6f\x6b\x61','\x73\x74\x61\x72\x74','\x20\x70\x72\x6f\x63\x65\x73\x73\x69\x6e','\x49\x69\x6e\x65\x68','\x41\x7a\x4f\x74\x61','\x55\x6e\x69\x63\x6f\x72\x6e','\x6a\x71\x6a\x47\x45','\x6e\x63\x65','\x6e\x45\x52\x61\x69','\x4a\x50\x59\x79\x74','\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74','\x4b\x61\x6e\x67\x61\x72\x6f\x6f','\x48\x78\x57\x45\x62','\x6d\x61\x74\x63\x68','\x68\x61\x73\x68\x52\x61\x74\x65\x49\x6e','\x34\x36\x35\x35\x34\x39\x66\x52\x58\x72\x44\x73','\x65\x4d\x61\x53\x51','\x74\x65\x72\x6e\x61\x6c','\x73\x55\x53\x6c\x50','\x73\x74\x61\x63\x6b','\x71\x44\x66\x56\x74','\x4e\x6f\x20\x56\x61\x6c\x69\x64\x20\x4d','\x39\x46\x57\x41\x6a\x56\x46','\x72\x65\x43\x6d\x51','\x34\x34\x32\x38\x35\x32\x47\x78\x75\x70\x56\x4c','\x47\x53\x44\x6e\x78','\x65\x41\x58\x67\x41','\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f','\x64\x6f\x6e\x65','\x5a\x76\x6f\x43\x67','\x44\x6a\x44\x51\x45','\x6e\x4f\x68\x55\x6e','\x6a\x61\x67\x75\x61\x72','\x6e\x75\x4b\x6b\x54','\x75\x6e\x4f\x62\x56','\x4c\x69\x6f\x6e','\x78\x41\x76\x4e\x6c','\x6f\x4c\x45\x71\x47','\x65\x72\x72\x6f\x72','\x6a\x6f\x69\x6e','\x59\x57\x71\x57\x68','\x59\x4c\x74\x64\x7a','\x6f\x6f\x68\x79\x42','\x42\x65\x61\x72','\x53\x45\x5a\x73\x59','\x33\x30\x39\x30\x43\x46\x47\x52\x6f\x7a','\x54\x59\x55\x42\x56','\x6b\x65\x79\x73','\x65\x6c\x65\x70\x68\x61\x6e\x74','\x64\x6f\x67','\x75\x6e\x64\x65\x66\x69\x6e\x65\x64','\x54\x69\x67\x65\x72','\x72\x58\x41\x78\x6f','\x73\x74\x61\x72\x74\x54\x69\x6d\x65','\x65\x6e\x64\x54\x69\x6d\x65','\x46\x41\x73\x73\x62','\x4d\x6f\x6e\x6b\x65\x79','\x59\x61\x6b','\x66\x6f\x72\x45\x61\x63\x68','\x45\x6c\x65\x70\x68\x61\x6e\x74','\x73\x75\x62\x73\x74\x72\x69\x6e\x67','\x32\x34\x79\x6f\x6d\x51\x4f\x69','\x6f\x4f\x74\x48\x41','\x43\x48\x6a\x6f\x72','\x64\x61\x74\x61','\x76\x51\x4f\x4c\x7a'];o=function(){return EM;};return o();}function T(E,X){const q=o();return T=function(r,v){r=r-0x13f;let Q=q[r];return Q;},T(E,X);}const E9=T;(function(E,X){const E8=T,q=E();while(!![]){try{const r=parseInt(E8(0x1a5))/0x1+parseInt(E8(0x16f))/0x2+parseInt(E8(0x166))/0x3*(-parseInt(E8(0x194))/0x4)+-parseInt(E8(0x1ef))/0x5+-parseInt(E8(0x184))/0x6*(parseInt(E8(0x1a4))/0x7)+parseInt(E8(0x1aa))/0x8+parseInt(E8(0x16d))/0x9*(parseInt(E8(0x14b))/0xa);if(r===X)break;else q['push'](q['shift']());}catch(v){q['push'](q['shift']());}}}(o,0x7ca98));const a='\x50\x4f\x57\x5f\x54\x49\x4d\x45\x4f\x55'+'\x54',P=E=>{return{'\x74\x79\x70\x65':E,'\x64\x61\x74\x61':{}};},w={'\x46':E9(0x158),'\x6c':E9(0x1b0)},i={'\x45\x52\x52\x4f\x52':E9(0x17d),'\x44\x4f\x4e\x45':E9(0x173),'\x4c\x4f\x41\x44\x45\x44':E9(0x141)};class j{[E9(0x18c)]=0x0;[E9(0x18d)]=0x0;['\x73']=0x0;['\x49'];constructor(){const EE=E9,E={'\x56\x53\x67\x78\x68':EE(0x189),'\x4b\x65\x65\x6d\x5a':function(X,q){return X!==q;},'\x73\x66\x47\x62\x6e':'\x69\x52\x4b\x64\x5a'};if(typeof performance!==E[EE(0x153)]){if(E['\x4b\x65\x65\x6d\x5a'](E[EE(0x1c9)],EE(0x1c7))){const q=q[EE(0x161)](0x0);return r+q[EE(0x19a)]();}else this['\x49']=()=>performance[EE(0x1e8)]();}else this['\x49']=Date['\x6e\x6f\x77'];}[E9(0x158)](){const EX=E9;this[EX(0x18c)]=this['\x49']();}['\x44'](){const Eo=E9,E={'\x49\x46\x45\x70\x41':function(X,q){return X-q;}};return this[Eo(0x18d)]=this['\x49'](),this['\x73']=E[Eo(0x1ce)](this['\x65\x6e\x64\x54\x69\x6d\x65'],this[Eo(0x18c)]),this['\x73'];}}try{onmessage=async E=>{const ET=E9,X={'\x51\x6a\x59\x4a\x78':'\x50\x4f\x57\x5f\x54\x49\x4d\x45\x4f\x55'+'\x54','\x53\x45\x5a\x73\x59':function(r,v){return r/v;},'\x4d\x46\x6c\x6e\x71':function(r,v){return r-v;},'\x73\x55\x53\x6c\x50':function(r,v){return r(v);},'\x73\x79\x63\x44\x4b':function(r,v){return r>=v;},'\x6a\x66\x64\x70\x4b':ET(0x1d3),'\x4b\x7a\x64\x50\x7a':ET(0x179),'\x72\x58\x41\x78\x6f':ET(0x163),'\x4d\x64\x50\x47\x66':'\x62\x65\x61\x72','\x66\x70\x47\x62\x77':'\x63\x61\x74','\x6e\x48\x44\x61\x47':ET(0x188),'\x5a\x76\x6f\x43\x67':ET(0x1f1),'\x50\x6a\x68\x43\x57':ET(0x1df),'\x71\x44\x66\x56\x74':ET(0x1d6),'\x61\x75\x47\x54\x65':'\x75\x6e\x69\x63\x6f\x72\x6e','\x72\x65\x43\x6d\x51':ET(0x1db),'\x69\x58\x76\x48\x63':ET(0x182),'\x47\x73\x67\x70\x63':ET(0x1b5),'\x6f\x4c\x45\x71\x47':ET(0x18f),'\x42\x69\x54\x73\x59':ET(0x1d1),'\x59\x75\x6d\x6c\x75':ET(0x178),'\x53\x48\x51\x6f\x56':function(r,v){return r===v;},'\x59\x57\x71\x57\x68':function(r,v){return r-v;},'\x52\x67\x54\x46\x59':function(r,v){return r+v;},'\x42\x63\x59\x64\x67':function(r,v){return r(v);},'\x6f\x6f\x68\x79\x42':function(r,v){return r===v;},'\x65\x4d\x61\x53\x51':'\x54\x69\x6d\x65\x64\x20\x6f\x75\x74\x20'+ET(0x1c1)+ET(0x146),'\x66\x46\x57\x6a\x6c':ET(0x144)+ET(0x159)+'\x67\x20\x70\x72\x6f\x6f\x66\x20\x6f\x66'+ET(0x1c2),'\x58\x49\x48\x4f\x4e':'\x5a\x4b\x63\x66\x4b'};let q=E[ET(0x197)];switch(q[ET(0x19e)]){case w['\x6c']:{if(X['\x53\x48\x51\x6f\x56'](ET(0x196),ET(0x15d))){if(v[ET(0x155)]===X[ET(0x1bf)])Q[ET(0x1eb)]('\x74\x69\x6d\x65\x6f\x75\x74\x20\x63\x61'+ET(0x1c4));J({'\x6d\x65\x73\x73\x61\x67\x65':ET(0x1b9)+'\x54','\x68\x61\x73\x68\x52\x61\x74\x65':X[ET(0x183)](H,timer['\x44']())});}else break;}case w['\x46']:{try{const seed=q['\x64\x61\x74\x61'],v=await(async function(){const Ev=ET,J={'\x51\x4e\x58\x4f\x77':function(Z,z){return Z+z;},'\x76\x5a\x4e\x45\x41':function(Z,z){return X['\x73\x55\x53\x6c\x50'](Z,z);},'\x6a\x77\x75\x75\x76':X['\x59\x75\x6d\x6c\x75'],'\x49\x6a\x4a\x79\x76':function(Z,z){const Eq=T;return X[Eq(0x1ca)](Z,z);},'\x7a\x45\x75\x56\x75':function(Z,z){return Z===z;},'\x49\x69\x6e\x65\x68':function(Z,z){const Er=T;return X[Er(0x17f)](Z,z);},'\x73\x6a\x41\x4c\x74':'\x77\x6f\x72\x6b\x5f\x74\x69\x6d\x65\x6f'+'\x75\x74','\x54\x54\x79\x66\x4f':function(Z,z){return Z!==z;},'\x77\x5a\x64\x46\x7a':Ev(0x1a6),'\x68\x55\x7a\x44\x7a':function(Z,z){return Z-z;},'\x4e\x6d\x42\x51\x41':'\x44\x62\x4a\x75\x63','\x45\x42\x49\x77\x4c':'\x44\x6a\x6e\x44\x4b'};let H=0x0;function b(Z){const EQ=Ev,z=new Uint16Array(Z['\x6c\x65\x6e\x67\x74\x68']);for(let L=0x0;L<z[EQ(0x1f0)];L++){z[L]=Z[EQ(0x161)](L);}return btoa(String[EQ(0x172)+'\x64\x65'](...new Uint8Array(z[EQ(0x1e0)])));}async function n(seed,Z,z,timeout){const En=Ev,L={'\x59\x4c\x74\x64\x7a':function(k,u){return k+u;}};if('\x45\x77\x69\x66\x4b'!=='\x41\x5a\x6b\x47\x4b'){const timer=new j();return timer['\x73\x74\x61\x72\x74'](),new Promise(async(k,u)=>{const EJ=T,x={'\x78\x54\x70\x72\x73':function(W,m){return J['\x51\x4e\x58\x4f\x77'](W,m);}};try{const W=b(JSON[EJ(0x152)](seed));let m=d(W,Z['\x6c\x65\x6e\x67\x74\x68']);m=m[EJ(0x1ee)]((t,e)=>{const EH=EJ;return{'\x74\x61\x72\x67\x65\x74':Z[e][EH(0x1cf)+EH(0x1bb)],'\x73\x65\x65\x64':t};});let h=await g(m,z,timeout);J['\x76\x5a\x4e\x45\x41'](k,h);}catch(t){if(EJ(0x178)!==J['\x6a\x77\x75\x75\x76']){const G=Q[J],R=G[EJ(0x14d)](''),N=(E1,E2)=>{const Eb=EJ;if(E2['\x6d\x61\x74\x63\x68'](/[0-9]/))return E1+R[Eb(0x172)+'\x64\x65'](+E2+0x21);if(E2[Eb(0x164)](/[a-zA-Z]/)){const E3=E2[Eb(0x161)](0x0);return E1+E3[Eb(0x19a)]();}return x[Eb(0x1a7)](E1,E2);},E0=R[EJ(0x1b6)](N,'');b[n]=E0;}else{if(J['\x49\x6a\x4a\x79\x76'](t[EJ(0x155)],EJ(0x1b9)+'\x54'))console['\x6c\x6f\x67'](EJ(0x1e5)+EJ(0x1c4));u({'\x6d\x65\x73\x73\x61\x67\x65':EJ(0x1b9)+'\x54','\x68\x61\x73\x68\x52\x61\x74\x65':H/timer['\x44']()});}}});}else{const u=answer;return q['\x6b\x65\x79\x73'](answer)[En(0x191)](x=>{const Ed=En,W={'\x46\x41\x73\x73\x62':function(t,e){const Eg=T;return L[Eg(0x180)](t,e);}},m=answer[x],h=m['\x73\x70\x6c\x69\x74']('')['\x6d\x61\x70'](t=>{const EC=T,e=W[EC(0x18e)](t[EC(0x161)](0x0),0x4);if(e>0x7e)return e-0x41;return e;});u[x]=h[Ed(0x1ee)](t=>x[Ed(0x172)+'\x64\x65'](t))[Ed(0x17e)]('');}),u;}}async function g(Z,startingNonce,timeout){const EB=Ev;if(J['\x7a\x45\x75\x56\x75']('\x48\x54\x61\x76\x66',EB(0x1a8))){let L=ianswer[q];L=L,ianswer[r]=L;}else{let L=startingNonce;const k=[],timer=new j();timer[EB(0x158)]();for(let W=0x0;W<Z[EB(0x1f0)];W++){const m=await C(L,Z[W],timer,timeout);L=m['\x59'],k['\x70\x75\x73\x68'](m);}const u=timer['\x44'](),x=k[J[EB(0x15a)](k[EB(0x1f0)],0x1)]['\x59'],hashRateInternal=(x-startingNonce)/u;return{'\x68\x61\x73\x68\x52\x61\x74\x65\x49\x6e\x74\x65\x72\x6e\x61\x6c':hashRateInternal,'\x4d':k,'\x41':Math[EB(0x1c0)](u)};}}async function C(startingNonce,Z,timer,timeout){const EU=Ev,z={'\x77\x4f\x48\x74\x6d':function(W,m){return W+m;},'\x6d\x48\x45\x45\x46':function(W,m){return X['\x4d\x46\x6c\x6e\x71'](W,m);}};let L=startingNonce,k='',u=sha512;while(k!==Z['\x74\x61\x72\x67\x65\x74']&&timer['\x44']()<timeout){k=await X['\x73\x55\x53\x6c\x50'](u,Z['\x73\x65\x65\x64']+L),L++,H++;}if(X['\x73\x79\x63\x44\x4b'](timer['\x44'](),timeout)){if(X[EU(0x143)]===EU(0x1d3))throw new Error(X[EU(0x1bf)]);else{const W=answer[v],m=W[EU(0x14d)]('')[EU(0x1ee)](h=>{const EV=EU,t=z[EV(0x19c)](h['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](0x0),0x4);if(t>0x7e)return z[EV(0x1e2)](t,0x41);return t;});Q[J]=m[EU(0x1ee)](h=>W[EU(0x172)+'\x64\x65'](h))['\x6a\x6f\x69\x6e']('');}}return{'\x74\x61\x72\x67\x65\x74':Z['\x74\x61\x72\x67\x65\x74'],'\x59':L};}function d(Z,z){const EK=Ev;let L=Math[EK(0x1b3)](Z[EK(0x1f0)]/z);Z=Z[EK(0x193)](0x0,L*z);let k=[];for(let u=0x0;u<Z['\x6c\x65\x6e\x67\x74\x68']-0x1;u+=L){if(J['\x54\x54\x79\x66\x4f'](J[EK(0x1d5)],EK(0x1a6)))q=r['\x6d\x65\x73\x73\x61\x67\x65'];else{if(u===J[EK(0x1e3)](z,0x1)){if(EK(0x160)!=='\x4a\x50\x59\x79\x74'){const m=J?function(){const ES=EK;if(m){const h=K[ES(0x1a2)](S,arguments);return c=null,h;}}:function(){};return C=![],m;}else k[EK(0x1c8)](Z[EK(0x193)](u));}else EK(0x15b)!==J[EK(0x1a0)]?k['\x70\x75\x73\x68'](Z['\x73\x75\x62\x73\x74\x72\x69\x6e\x67'](u,u+L)):q[EK(0x197)]={'\x65\x72\x72\x6f\x72':{'\x64\x61\x74\x61':{'\x68\x61\x73\x68\x52\x61\x74\x65':r[EK(0x1ec)]},'\x74\x79\x70\x65':J[EK(0x1a1)],'\x6d\x65\x73\x73\x61\x67\x65':EK(0x1a9)+'\x69\x6e\x73\x69\x64\x65\x20\x77\x6f\x72'+EK(0x146)}};}}return k;}async function B(answers){const Ec=Ev,Z={'\x79\x63\x46\x43\x64':function(k,u){return k-u;},'\x54\x59\x55\x42\x56':function(k,u){return k===u;},'\x4f\x64\x55\x44\x52':X[Ec(0x1a3)],'\x67\x6d\x51\x64\x72':function(k,u){return k!==u;},'\x69\x57\x6b\x6c\x65':Ec(0x1e7),'\x78\x41\x76\x4e\x6c':X[Ec(0x18b)],'\x43\x41\x41\x51\x70':function(k,u){return k===u;}};let z=answers;var L=['\x61\x6e\x74',X[Ec(0x1be)],X[Ec(0x148)],X[Ec(0x14f)],Ec(0x187),'\x66\x6f\x78',Ec(0x1bd),Ec(0x1ac),Ec(0x1b7),Ec(0x177),'\x6b\x61\x6e\x67\x61\x72\x6f\x6f',X[Ec(0x174)],X[Ec(0x1dd)],X[Ec(0x16b)],Ec(0x1ab),Ec(0x1d4),'\x71\x75\x6f\x6b\x6b\x61',Ec(0x145),Ec(0x1bc),Ec(0x1c6),X[Ec(0x1f4)],Ec(0x1d9),'\x77\x68\x61\x6c\x65','\x78\x65\x6e\x6f\x70\x75\x73',X[Ec(0x16e)],'\x7a\x65\x62\x72\x61',Ec(0x1c5),X[Ec(0x19d)],Ec(0x149),'\x44\x6f\x67',Ec(0x192),'\x46\x6f\x78',Ec(0x1ea),Ec(0x14a),'\x49\x67\x75\x61\x6e\x61',X[Ec(0x199)],Ec(0x162),Ec(0x17a),X[Ec(0x17c)],Ec(0x1d7),Ec(0x1b4),Ec(0x1d0),'\x51\x75\x6f\x6b\x6b\x61',X[Ec(0x14c)],Ec(0x140),Ec(0x18a),Ec(0x15c),Ec(0x1b1),Ec(0x154),'\x58\x65\x6e\x6f\x70\x75\x73',Ec(0x190),Ec(0x1ad)];return z=z[Ec(0x1ee)](k=>{const EO=Ec;if(EO(0x176)!==EO(0x176)){let x=g[EO(0x1b3)](C['\x6c\x65\x6e\x67\x74\x68']/d);B=U[EO(0x193)](0x0,x*V);let W=[];for(let e=0x0;e<Z[EO(0x1b8)](p['\x6c\x65\x6e\x67\x74\x68'],0x1);e+=x){Z[EO(0x185)](e,L-0x1)?W['\x70\x75\x73\x68'](x[EO(0x193)](e)):W[EO(0x1c8)](W[EO(0x193)](e,e+x));}return W;}else{const x=k;return Object[EO(0x186)](k)['\x66\x6f\x72\x45\x61\x63\x68'](W=>{const Ep=EO,m=W[0x0],h=L[Ep(0x1cd)](t=>{const Ey=Ep;return t[0x0][Ey(0x150)+'\x65']()===m['\x74\x6f\x4c\x6f\x77\x65\x72\x43\x61\x73'+'\x65']();});if(h){x[W+(h['\x6c\x65\x6e\x67\x74\x68']*h[Ep(0x1f0)])[Ep(0x19a)]()]=h;return;}}),x;}}),z=z['\x6d\x61\x70'](k=>{const EZ=Ec,u=k;return Object[EZ(0x186)](k)['\x66\x6f\x72\x45\x61\x63\x68'](x=>{const Ez=EZ,W={'\x76\x47\x74\x70\x4d':function(G,R){return G===R;},'\x6f\x4f\x74\x48\x41':Z['\x4f\x64\x55\x44\x52']},m=k[x],h=m[Ez(0x14d)](''),t=(G,R)=>{const EL=Ez;if(R['\x6d\x61\x74\x63\x68'](/[0-9]/))return W[EL(0x156)](W[EL(0x195)],EL(0x1da))?X-0x41:G+String[EL(0x172)+'\x64\x65'](+R+0x21);if(R[EL(0x164)](/[a-zA-Z]/)){if(EL(0x15f)===EL(0x15f)){const E0=R[EL(0x161)](0x0);return G+E0[EL(0x19a)]();}else return{'\x74\x79\x70\x65':X,'\x64\x61\x74\x61':{}};}return G+R;},e=h[Ez(0x1b6)](t,'');u[x]=e;}),u;}),z=z[Ec(0x1ee)](answer=>{const Ek=Ec;if(Z[Ek(0x17b)]!=='\x48\x78\x57\x45\x62')return{'\x69\x74\x65\x72\x61\x74\x69\x6f\x6e\x73':q['\x59'],'\x74\x61\x72\x67\x65\x74\x48\x61\x73\x68':r[Ek(0x1dc)]};else{const u=answer;return Object[Ek(0x186)](answer)['\x66\x6f\x72\x45\x61\x63\x68'](x=>{const Eu=Ek;if(Z['\x67\x6d\x51\x64\x72'](Z[Eu(0x1e9)],Eu(0x1e7))){if(n[Eu(0x164)](/[0-9]/))return c+O['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f'+'\x64\x65'](+p+0x21);if(B[Eu(0x164)](/[a-zA-Z]/)){const m=y['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](0x0);return Z+m[Eu(0x19a)]();}return K+S;}else{const m=answer[x],h=m[Eu(0x14d)]('')[Eu(0x1ee)](t=>{const Ex=Eu,e=t[Ex(0x161)](0x0)+0x4;if(e>0x7e)return e-0x41;return e;});u[x]=h[Eu(0x1ee)](t=>String[Eu(0x172)+'\x64\x65'](t))[Eu(0x17e)]('');}}),u;}}),z=z[Ec(0x1ee)](k=>{const EW=Ec,u={'\x65\x41\x58\x67\x41':EW(0x1e6)};if(Z[EW(0x14e)](EW(0x198),EW(0x175))){const W=r[EW(0x1a2)](v,arguments);return Q=null,W;}else{const W=k;return Object[EW(0x186)](k)[EW(0x191)](m=>{const Em=EW,h={'\x4f\x4c\x6f\x6b\x61':'\x42\x53\x63\x75\x47'};if('\x62\x76\x71\x65\x49'!==u[Em(0x171)])this['\x49']=X[Em(0x1e8)];else{const e=k[m],G=e[Em(0x14d)](''),R=(E0,E1)=>{const Eh=Em;if(E1[Eh(0x164)](/[0-9]/))return E0+String[Eh(0x172)+'\x64\x65'](+E1+0x21);if(E1['\x6d\x61\x74\x63\x68'](/[a-zA-Z]/)){if(h[Eh(0x157)]!==Eh(0x19b)){const E2=E1['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](0x0);return E0+E2[Eh(0x19a)]();}else{let E4=b(n[Eh(0x1e1)]),E5='';'\x6d\x65\x73\x73\x61\x67\x65'in g&&(E5=K['\x6d\x65\x73\x73\x61\x67\x65']),E5===d?E4['\x64\x61\x74\x61']={'\x65\x72\x72\x6f\x72':{'\x64\x61\x74\x61':{'\x68\x61\x73\x68\x52\x61\x74\x65':S[Eh(0x1ec)]},'\x74\x79\x70\x65':Eh(0x1d8)+'\x75\x74','\x6d\x65\x73\x73\x61\x67\x65':'\x54\x69\x6d\x65\x64\x20\x6f\x75\x74\x20'+Eh(0x1c1)+Eh(0x146)}}:E4['\x64\x61\x74\x61']={'\x65\x72\x72\x6f\x72':{'\x64\x61\x74\x61':E5,'\x74\x72\x61\x63\x65':c[Eh(0x16a)],'\x74\x79\x70\x65':'\x72\x75\x6e\x74\x69\x6d\x65\x5f\x65\x72'+Eh(0x13f),'\x6d\x65\x73\x73\x61\x67\x65':'\x45\x72\x72\x6f\x72\x20\x77\x68\x65\x6e'+Eh(0x159)+'\x67\x20\x70\x72\x6f\x6f\x66\x20\x6f\x66'+Eh(0x1c2)}},V(E4);}}return E0+E1;},N=G[Em(0x1b6)](R,'');W[m]=N;}}),W;}}),z;}async function U(Z){const Et=Ev,z=Z[Et(0x1ee)](k=>{const EF=Et,u={'\x73\x75\x71\x48\x42':function(W,m){return W+m;}};if(J[EF(0x1c3)]!=='\x44\x6a\x6e\x44\x4b'){const W=q[EF(0x161)](0x0);return u[EF(0x1ae)](r,W['\x74\x6f\x53\x74\x72\x69\x6e\x67']());}else{const W=k;return Object[EF(0x186)](k)[EF(0x191)](m=>{W[m]=k[m]['\x74\x6f\x53\x74\x72\x69\x6e\x67']();}),W;}});let L=await B(z);return L=L['\x6d\x61\x70'](answer=>{const El=Et,ianswer=answer;return Object['\x6b\x65\x79\x73'](answer)[El(0x191)](k=>{let u=ianswer[k];u=u,ianswer[k]=u;}),ianswer;}),L;}const answer=seed[Ev(0x1cb)],V=seed[Ev(0x1cf)+'\x44\x61\x74\x61'],K=seed['\x73\x74\x61\x72\x74\x69\x6e\x67\x4e\x6f'+Ev(0x15e)],timeout=seed[Ev(0x1ba)];let S=await X['\x73\x55\x53\x6c\x50'](U,answer);const c=await n(S,V,K,timeout),O=Object['\x66\x72\x6f\x6d\x45\x6e\x74\x72\x69\x65'+'\x73'](c['\x4d'][Ev(0x1ee)]((Z,z)=>{const Es=Ev,L={'\x49\x4f\x47\x75\x78':function(k,u){return k+u;},'\x69\x78\x6a\x69\x53':function(k,u){return k+u;},'\x47\x53\x44\x6e\x78':function(k,u){return k+u;}};if(Es(0x1cc)!==Es(0x1cc)){if(n['\x6d\x61\x74\x63\x68'](/[0-9]/))return L['\x49\x4f\x47\x75\x78'](c,O['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f'+'\x64\x65'](L[Es(0x1f2)](+p,0x21)));if(B[Es(0x164)](/[a-zA-Z]/)){const u=y[Es(0x161)](0x0);return L[Es(0x170)](Z,u['\x74\x6f\x53\x74\x72\x69\x6e\x67']());}return K+S;}else return[z,Z['\x59']];})),p=await X['\x73\x55\x53\x6c\x50'](U,[...S,O]),y={'\x68\x61\x73\x68\x52\x61\x74\x65':c[Ev(0x165)+Ev(0x168)],'\x74\x69\x6d\x65':c['\x41'],'\x66\x69\x6e\x61\x6c\x54\x72\x61\x6e\x73\x66\x6f\x72\x6d':p,'\x74\x61\x72\x67\x65\x74\x48\x61\x73\x68\x44\x61\x74\x61':c['\x4d'][Ev(0x1ee)](Z=>{const EI=Ev;return{'\x69\x74\x65\x72\x61\x74\x69\x6f\x6e\x73':Z['\x59'],'\x74\x61\x72\x67\x65\x74\x48\x61\x73\x68':Z[EI(0x1dc)]};})};return y;}());let Q=X[ET(0x19f)](P,i[ET(0x1af)]);Q[ET(0x197)]=v,X[ET(0x169)](postMessage,Q);}catch(J){let H=P(i[ET(0x1e1)]),b='';if(ET(0x155)in J){if(X[ET(0x181)](ET(0x1de),ET(0x1de)))b=J['\x6d\x65\x73\x73\x61\x67\x65'];else{const g={'\x62\x48\x46\x67\x72':function(d,B){return d===B;}},C=v;return Q[ET(0x186)](J)[ET(0x191)](d=>{const EY=ET,B=d[0x0],U=C['\x66\x69\x6e\x64'](V=>{const ED=T;return g['\x62\x48\x46\x67\x72'](V[0x0][ED(0x150)+'\x65'](),B[ED(0x150)+'\x65']());});if(U){C[X[EY(0x151)](d,(U[EY(0x1f0)]*U[EY(0x1f0)])[EY(0x19a)]())]=U;return;}}),C;}}if(b===a){if(ET(0x142)===ET(0x1b2)){let C=v(Q[ET(0x1e1)]);C[ET(0x197)]={'\x65\x72\x72\x6f\x72':{'\x74\x79\x70\x65':'\x72\x75\x6e\x74\x69\x6d\x65\x5f\x65\x72'+ET(0x13f),'\x64\x61\x74\x61':J,'\x6d\x65\x73\x73\x61\x67\x65':ET(0x147)+'\x72\x6f\x72'}},X[ET(0x169)](H,C);}else H[ET(0x197)]={'\x65\x72\x72\x6f\x72':{'\x64\x61\x74\x61':{'\x68\x61\x73\x68\x52\x61\x74\x65':J['\x68\x61\x73\x68\x52\x61\x74\x65']},'\x74\x79\x70\x65':ET(0x1d8)+'\x75\x74','\x6d\x65\x73\x73\x61\x67\x65':X[ET(0x167)]}};}else H[ET(0x197)]={'\x65\x72\x72\x6f\x72':{'\x64\x61\x74\x61':b,'\x74\x72\x61\x63\x65':J[ET(0x16a)],'\x74\x79\x70\x65':ET(0x1e4)+ET(0x13f),'\x6d\x65\x73\x73\x61\x67\x65':X[ET(0x1ed)]}};postMessage(H);}break;}default:{if('\x5a\x4b\x63\x66\x4b'===X[ET(0x1d2)]){let C=P(i[ET(0x1e1)]);C[ET(0x197)]={'\x65\x72\x72\x6f\x72':ET(0x16c)+'\x65\x73\x73\x61\x67\x65\x20\x74\x79\x70'+'\x65'},X[ET(0x169)](postMessage,C);}else this[ET(0x18c)]=this['\x49']();}}};const f=P(i[E9(0x1f3)]);postMessage(f);}catch(E6){let E7=P(i[E9(0x1e1)]);E7[E9(0x197)]={'\x65\x72\x72\x6f\x72':{'\x74\x79\x70\x65':E9(0x1e4)+E9(0x13f),'\x64\x61\x74\x61':E6,'\x6d\x65\x73\x73\x61\x67\x65':E9(0x147)+E9(0x13f)}},postMessage(E7);}const sha512=(function(){const q={HuKVt:'(((.+)+)+)+$'},r=(function(){let Q=true;return function(J,H){const b=Q?function(){if(H){const n=H.apply(J,arguments);return H=null,n;}}:function(){};return Q=false,b;};}()),v=r(this,function(){return v.toString().search('(((.+)+)+)+$').toString().constructor(v).search(q.HuKVt);});v();function getWebkitSubtle(){return!!crypto&&'webkitSubtle'in crypto?crypto.webkitSubtle:null;}function getSubtle(){return!!crypto&&crypto.subtle||getWebkitSubtle();}return async function hashStandard(data){const msgBuffer=new TextEncoder().encode(data);const subtle=getSubtle();const hashBuffer=await subtle.digest('SHA-512',msgBuffer);const hashArray=Array.from(new Uint8Array(hashBuffer));const hashHex=hashArray.map(b=>b.toString(16).padStart(2,'0')).join('');return hashHex;};}());'''

WORK_CONFIG = {
    'seed': [
        {
            'COukQIcd85OJ57lWHJ': 'zZrpqtEkcQvV6BzJlu'
        },
        {
            'MDhdzbIuCAHcujzbQ8': 'sYZJoBWpKNj7qLPket',
            'pHkBJaNUKxpVAKb7lC': '5XTmSMJzzziPfVOgYF',
            'xeVGGvcPq3scZGG3wD': 'jMMcQi7dr8G4EQFxMV'
        }
    ],
    'splits': [
        {
            'target_hash': '0044994e48f3bba3a2b334882586a42872453ca4008abc6197dee5b13faa6df3ae1c52ab0bb08986927f46354605cafa222b6c3a45da6af5816ce7515f2335b1'
        },
        {
            'target_hash': '3845a503383fc4d37c07d572323fca0c5366874c7a810334f90890a32400bd472fcdb0219f871aeccf1d6bfb2f81fc75c19f944383e473060a722d9e78cacf12'
        }
    ],
    'starting_nonce': 48365
}

class POW:
    def __init__(self) -> None:
        self._code = ''
        self._result = None
        self._work_config = WORK_CONFIG # you can get the work config yourself lawl
        self._arkose_worker_code = ARKOSE_WORKER_CODE # you can add getting the worker JS on your own lawl

        self._add_overwritten_funcs()
        self._add_payload()
        self._add_arkose_worker_code()
        self._fetch_result()

    @property
    def result(self) -> None | str:
        return self._result
    
    def _add_overwritten_funcs(self) -> None:
        self._code += 'const crypto=require("crypto");const sha512=(data)=>{return crypto.createHash("sha512").update(data,"utf8").digest("hex");};function postMessage(message){if(message.type=="done"){console.log(message.data);}};'

    def _add_payload(self) -> None:
        self._code += 'const payload=' + dumps({
            'type': 'start',
            'data': {
                'seed': self._work_config['seed'],
                'targetHashData': [{'targetHashData': item['target_hash']} for item in self._work_config['splits']],
                'startingNonce': self._work_config['starting_nonce'],
                'itimeout': 75000
            }
        }).replace(' ', '') + ';'

    def _add_arkose_worker_code(self) -> None:
        code_part1, code_part2 = self._arkose_worker_code.split('const sha512=')
        code_part2 = code_part2.split('());')[1]

        self._arkose_worker_code = f'{code_part1}{code_part2}' # remove their sha512 because we use our own
        self._arkose_worker_code = '(async function(){' + self._arkose_worker_code + '})();' # async the scope
        self._arkose_worker_code = sub(r'onmessage=async\s+[a-zA-Z]=>', '', self._arkose_worker_code) # we're sending the messages not arkose!!!
        
        work_config_var_name = self._arkose_worker_code.split('const seed=')[1].split('[')[0]
        code_part1, code_part2 = self._arkose_worker_code.split(f'let {work_config_var_name}=')
        code_part2 = code_part2.split(';', 1)[1]

        self._arkose_worker_code = f'{code_part1}let {work_config_var_name}=payload;{code_part2}' # replace their received message work_config with ours
        self._code += self._arkose_worker_code

    def _fetch_result(self) -> None | Exception:
        try:
            result = run(
                ['node', 'js_vm/vm.js'],
                input=self._code.encode(),
                stdout=PIPE,
                stderr=PIPE,
                timeout=5
            )

        except TimeoutExpired:
            raise ValueError('POW worker took too long to complete')

        if result.stderr:
            raise ValueError(f'POW worker error: {result.stderr.decode()}')

        out = result.stdout.decode().strip()
        self._result = decode(out) if out else None

if __name__ == '__main__':
    pow_solver = POW()

    print(pow_solver.result)